<app-loms-layout
  organisationName="Loan Origination and Management System"
  solutionName="LOMS"
  breadcrumb="Product Configuration"
  basePath="/loms"
>
  <div class="px-2 py-4 bg-white-50 min-h-screen space-y-6 w-full flex-1 max-w-screen-lg mx-auto">
    <section class="space-y-4">
      <div class="flex items-center justify-between">
        <h1 class="text-2xl font-semibold text-slate-900">
          Loan Product Configuration
        </h1>
      </div>
      <div class="rounded-3xl border border-slate-100 bg-white px-8 py-7 shadow-sm">
        <div class="flex items-center justify-between">
          <ng-container *ngFor="let step of steps; let i = index; let last = last">
            <div class="flex flex-col items-center relative z-10" [class.flex-1]="!last">
              <button
                type="button"
                (click)="setActiveStep(step.id)"
                [disabled]="step.id > activeStep"
                class="flex h-8 w-8 items-center justify-center rounded-full text-xs font-semibold transition-colors duration-200 border"
                [ngClass]="{
                  'bg-blue-600 text-white border-blue-600 shadow-sm': step.id === activeStep,
                  'bg-blue-50 text-blue-600 border-blue-300': step.id < activeStep,
                  'bg-slate-100 text-slate-500 border-slate-200': step.id > activeStep
                }"
              >
                <span *ngIf="step.id >= activeStep">{{ step.id }}</span>
                <svg
                  *ngIf="step.id < activeStep"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                  class="w-5 h-5"
                >
                  <path
                    fill-rule="evenodd"
                    d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z"
                    clip-rule="evenodd"
                  />
                </svg>
              </button>
              <span
                class="absolute top-10 text-[11px] font-medium whitespace-nowrap"
                [ngClass]="{
                  'text-blue-600': step.id === activeStep,
                  'text-slate-600': step.id < activeStep,
                  'text-gray-500': step.id > activeStep
                }"
              >
                {{ step.label }}
              </span>
            </div>
            <div
              *ngIf="!last"
              class="flex-1 h-0.5 bg-gray-200 relative -top-3 -mx-4"
            >
              <div
                class="h-full bg-blue-600 transition-all duration-300"
                [style.width.%]="activeStep > step.id ? 100 : 0"
              ></div>
            </div>
          </ng-container>
        </div>
      </div>
    </section>

    <ng-container *ngIf="activeStep === 1">
      <section class="rounded-2xl border border-slate-200 bg-white px-6 py-5 shadow-sm space-y-4">
        <h2 class="text-lg font-semibold text-slate-900">
          Product Attributes &amp; Nature
        </h2>
        <div class="grid gap-4 md:grid-cols-2 text-sm">
          <div class="space-y-1">
            <div class="text-[11px] font-semibold text-slate-600">
              Business Line *
            </div>
            <select
              class="w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="selectedBusinessLine"
            >
              <option value="">Select...</option>
              <option *ngFor="let b of businessLines" [ngValue]="b">
                {{ b }}
              </option>
            </select>
          </div>
          <div class="space-y-1">
            <div class="text-[11px] font-semibold text-slate-600">
              Product Code *
            </div>
            <input
              class="w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="productCode"
            />
          </div>
          <div class="space-y-1">
            <div class="text-[11px] font-semibold text-slate-600">
              Product Name *
            </div>
            <input
              class="w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="productName"
            />
          </div>
          <div class="space-y-1">
  <div class="text-[11px] font-semibold text-slate-600">
    Product Type *
  </div>
  <select
    class="w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
    [(ngModel)]="selectedProductType"
  >
    <option value="">Select...</option>
    <option>Term Loan</option>
    <option>Revolving</option>
    <option>Overdraft</option>
    <option>Credit Card</option>
  </select>
</div>

<div class="space-y-1">
  <div class="text-[11px] font-semibold text-slate-600">
    Currency *
  </div>
  <select
    class="w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
    [(ngModel)]="selectedCurrency"
  >
    <option value="">Select...</option>
    <option>BDT</option>
    <option>USD</option>
    <option>EUR</option>
    <option>GBP</option>
  </select>
</div>

          <div class="space-y-1">
            <div class="text-[11px] font-semibold text-slate-600">
              Interest/Profit Type *
            </div>
            <select
              class="w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="selectedInterestType"
            >
              <option value="">Select...</option>
              <option *ngFor="let t of interestTypes" [ngValue]="t">
                {{ t }}
              </option>
            </select>
          </div>
        </div>

        <div class="space-y-1 text-sm">
          <div class="text-[11px] font-semibold text-slate-600">
            Description
          </div>
          <textarea
            rows="3"
            class="w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
            [(ngModel)]="description"
          ></textarea>
        </div>

        <div class="space-y-2 text-sm">
          <div class="text-[11px] font-semibold text-slate-600">
            Channel Availability
          </div>
          <div class="flex flex-wrap gap-4">
            <label class="inline-flex items-center gap-2 text-sm text-slate-700">
              <input type="checkbox" class="h-3.5 w-3.5 rounded border-slate-300" [(ngModel)]="channelBranch" />
              <span>Branch</span>
            </label>
            <label class="inline-flex items-center gap-2 text-sm text-slate-700">
              <input type="checkbox" class="h-3.5 w-3.5 rounded border-slate-300" [(ngModel)]="channelDigital" />
              <span>Digital</span>
            </label>
            <label class="inline-flex items-center gap-2 text-sm text-slate-700">
              <input type="checkbox" class="h-3.5 w-3.5 rounded border-slate-300" [(ngModel)]="channelAgent" />
              <span>Agent</span>
            </label>
          </div>
        </div>

        <div class="flex items-center justify-between pt-2">
          <button
            type="button"
            class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
            routerLink="/loms/product"
          >
            Cancel
          </button>
          <div class="flex items-center gap-2">
            <button
              type="button"
              class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
            >
              Save Draft
            </button>
            <button
              type="button"
              class="rounded-md bg-blue-600 px-4 py-2 text-xs font-semibold text-white hover:bg-blue-700"
              (click)="next()"
            >
              Next
            </button>
          </div>
        </div>
      </section>
    </ng-container>

    <ng-container *ngIf="activeStep === 2">
      <section class="rounded-2xl border border-slate-200 bg-white px-6 py-5 shadow-sm space-y-4">
        <h2 class="text-lg font-semibold text-slate-900">
          Customer Segment &amp; Eligibility
        </h2>
        <div class="grid gap-4 md:grid-cols-2 text-sm">
          <div class="space-y-1">
            <div class="text-[11px] font-semibold text-slate-600">
              Segment *
            </div>
            <select
              class="w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="selectedSegment"
            >              <option value="">Select...</option>

              <option *ngFor="let s of segments">
                {{ s }}
              </option>
            </select>
          </div>
          <div class="space-y-1">
            <div class="text-[11px] font-semibold text-slate-600">
              Gender
            </div>
            <select
              class="w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="selectedGender"
            >
              <option>Any</option>
              <option>Male</option>
              <option>Female</option>
            </select>
          </div>
          <div class="space-y-1">
            <div class="text-[11px] font-semibold text-slate-600">
              Co-applicant Required
            </div>
            <select
              class="w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="coApplicantRequired"
            >
              <option>None</option>
              <option>1</option>
              <option>2</option>
              <option>3</option>
            </select>
          </div>
          <div class="space-y-1">
            <div class="text-[11px] font-semibold text-slate-600">
              Guarantor Required
            </div>
            <select
              class="w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="guarantorRequired"
            >
              <option>None</option>
              <option>1</option>
              <option>2</option>
            </select>
          </div>
        </div>

        <div class="space-y-3 text-sm">
          <div class="text-[11px] font-semibold text-slate-600">
            Persona *
          </div>
          <div class="flex flex-wrap gap-4">
            <label class="inline-flex items-center gap-2">
              <input type="checkbox" class="h-3.5 w-3.5 rounded border-slate-300" [(ngModel)]="personaSalaried" />
              <span>Salaried</span>
            </label>
            <label class="inline-flex items-center gap-2">
              <input type="checkbox" class="h-3.5 w-3.5 rounded border-slate-300" [(ngModel)]="personaSelfEmployed" />
              <span>Self-employed</span>
            </label>
            <label class="inline-flex items-center gap-2">
              <input type="checkbox" class="h-3.5 w-3.5 rounded border-slate-300" [(ngModel)]="personaBusinessOwner" />
              <span>Business Owner</span>
            </label>
            <label class="inline-flex items-center gap-2">
              <input type="checkbox" class="h-3.5 w-3.5 rounded border-slate-300" [(ngModel)]="personaFreelancer" />
              <span>Freelancer</span>
            </label>
            <label class="inline-flex items-center gap-2">
              <input type="checkbox" class="h-3.5 w-3.5 rounded border-slate-300" [(ngModel)]="personaStudent" />
              <span>Student</span>
            </label>
          </div>
        </div>

        <div class="grid gap-4 md:grid-cols-4 text-sm">
          <div class="space-y-1">
            <div class="text-[11px] font-semibold text-slate-600">
              Min Age
            </div>
            <input
              class="w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="minAge"
            />
          </div>
          <div class="space-y-1">
            <div class="text-[11px] font-semibold text-slate-600">
              Max Age
            </div>
            <input
              class="w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="maxAge"
            />
          </div>
          <div class="space-y-1">
            <div class="text-[11px] font-semibold text-slate-600">
              Minimum Income
            </div>
            <input
              class="w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="minimumIncome"
            />
          </div>
          <div class="space-y-1">
            <div class="text-[11px] font-semibold text-slate-600">
              Business Vintage (months)
            </div>
            <input
              class="w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="businessVintageMonths"
            />
          </div>
        </div>

        <div class="flex items-center justify-between pt-2">
          <button
            type="button"
            class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700"
            routerLink="/loms/product"
          >
            Cancel
          </button>
          <div class="flex items-center gap-2">
            <button
              type="button"
              class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
            >
              Save Draft
            </button>
            <button
              type="button"
              class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
              (click)="previous()"
            >
              Previous
            </button>
            <button
              type="button"
              class="rounded-md bg-blue-600 px-4 py-2 text-xs font-semibold text-white hover:bg-blue-700"
              (click)="next()"
            >
              Next
            </button>
          </div>
        </div>
      </section>
    </ng-container>

    <ng-container *ngIf="activeStep === 3">
      <section class="rounded-2xl border border-slate-200 bg-white px-6 py-5 shadow-sm space-y-4 text-sm">
        <h2 class="text-lg font-semibold text-slate-900">
          Required Document Mapping
        </h2>
        <div class="space-y-3">
          <div class="text-[11px] font-semibold text-slate-600">
            Clone Documents Configuration
          </div>
          <div class="flex flex-wrap items-center gap-2">
            <select
              class="min-w-[220px] rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
            >
              <option>Select Product...</option>
              <option>Retail Home Loan (RET_HOME_LOAN)</option>
              <option>SME Growth Loan (SME_TERM_LOAN)</option>
              <option>Platinum Credit Card (CC_PLATINUM)</option>
            </select>
            <button
              type="button"
              class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
            >
              Clone Documents
            </button>
          </div>
        </div>

        <div class="mt-4 space-y-3">
          <button
            type="button"
            class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
            (click)="addDocument()"
          >
            + Add Document
          </button>

          <div class="overflow-x-auto rounded-md border border-slate-200">
            <table class="min-w-full border-collapse text-xs">
              <thead class="bg-slate-50 text-[11px] font-semibold text-slate-600">
                <tr>
                  <th class="px-4 py-2 text-left">Document Type</th>
                  <th class="px-4 py-2 text-left">Persona Type</th>
                  <th class="px-4 py-2 text-left">Workflow Stage</th>
                  <th class="px-4 py-2 text-left">Required?</th>
                  <th class="px-4 py-2 text-left">Conditional Rule</th>
                  <th class="px-4 py-2 text-left">Notes</th>
                  <th class="px-4 py-2 text-left">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let doc of documents; let i = index">
                  <td class="px-4 py-2">
                    <select
                      class="w-full rounded-md border border-slate-300 bg-white px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                      [(ngModel)]="doc.documentType"
                    >
                      <option value="" disabled>Select</option>
                      <option *ngFor="let dt of documentTypes" [ngValue]="dt">
                        {{ dt }}
                      </option>
                    </select>
                  </td>
                  <td class="px-4 py-2">
                    <select
                      class="w-full rounded-md border border-slate-300 bg-white px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                      [(ngModel)]="doc.personaType"
                    >
                      <option value="" disabled>Select</option>
                      <option *ngFor="let p of personaTypes" [ngValue]="p">
                        {{ p }}
                      </option>
                    </select>
                  </td>
                  <td class="px-4 py-2">
                    <select
                      class="w-full rounded-md border border-slate-300 bg-white px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                      [(ngModel)]="doc.workflowStage"
                    >
                      <option value="" disabled>Select</option>
                      <option *ngFor="let stage of workflowStages" [ngValue]="stage">
                        {{ stage }}
                      </option>
                    </select>
                  </td>
                  <td class="px-4 py-2">
                    <select
                      class="w-full rounded-md border border-slate-300 bg-white px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                      [(ngModel)]="doc.required"
                    >
                      <option value="" disabled>Select</option>
                      <option *ngFor="let r of requiredOptions" [ngValue]="r">
                        {{ r }}
                      </option>
                    </select>
                  </td>
                  <td class="px-4 py-2">
                    <input
                      class="w-full rounded-md border border-slate-300 px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                      [(ngModel)]="doc.conditionalRule"
                    />
                  </td>
                  <td class="px-4 py-2">
                    <input
                      class="w-full rounded-md border border-slate-300 px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                      [(ngModel)]="doc.notes"
                    />
                  </td>
                  <td class="px-4 py-2">
                    <button
                      type="button"
                      class="rounded-md bg-red-500 px-2 py-1 text-[11px] font-semibold text-white"
                      (click)="removeDocument(i)"
                    >
                      X
                    </button>
                  </td>
                </tr>
                <tr *ngIf="!documents.length">
                  <td class="px-4 py-3 text-center text-[11px] text-slate-500" colspan="7">
                    No documents added yet. Use "Add Document" to configure required documents.
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="flex items-center justify-between pt-4">
          <button
            type="button"
            class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
            routerLink="/loms/product"
          >
            Cancel
          </button>
          <div class="flex items-center gap-2">
            <button
              type="button"
              class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
            >
              Save Draft
            </button>
            <button
              type="button"
              class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
              (click)="previous()"
            >
              Previous
            </button>
            <button
              type="button"
              class="rounded-md bg-blue-600 px-4 py-2 text-xs font-semibold text-white hover:bg-blue-700"
              (click)="next()"
            >
              Next
            </button>
          </div>
        </div>
      </section>
    </ng-container>

    <ng-container *ngIf="activeStep === 4">
      <section class="rounded-2xl border border-slate-200 bg-white px-6 py-5 shadow-sm space-y-4 text-sm">
        <div class="flex items-center justify-between">
          <h2 class="text-lg font-semibold text-slate-900">
            Security / Collateral Mapping
          </h2>
          
        </div>

        <div class="mt-3 space-y-3">
          <button
            type="button"
            class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
            (click)="addSecurity()"
          >
            + Add Security
          </button>

          <div class="overflow-x-auto rounded-md border border-slate-200">
            <table class="min-w-full border-collapse text-xs">
              <thead class="bg-slate-50 text-[11px] font-semibold text-slate-600">
                <tr>
                  <th class="px-4 py-2 text-left">Security Type</th>
                  <th class="px-4 py-2 text-left">Valuation Req?</th>
                  <th class="px-4 py-2 text-left">Margin %</th>
                  <th class="px-4 py-2 text-left">LTV %</th>
                  <th class="px-4 py-2 text-left">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let sec of securities; let i = index">
                  <td class="px-4 py-2">
                    <select
                      class="w-full rounded-md border border-slate-300 bg-white px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                      [(ngModel)]="sec.securityType"
                    >
                      <option value="" disabled>Select</option>
                      <option *ngFor="let s of securityTypes" [ngValue]="s">
                        {{ s }}
                      </option>
                    </select>
                  </td>
                  <td class="px-4 py-2">
                    <select
                      class="w-full rounded-md border border-slate-300 bg-white px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                      [(ngModel)]="sec.valuationRequired"
                    >
                      <option value="" disabled>Select</option>
                      <option *ngFor="let r of requiredOptions" [ngValue]="r">
                        {{ r }}
                      </option>
                    </select>
                  </td>
                  <td class="px-4 py-2">
                    <input
                      class="w-full rounded-md border border-slate-300 px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                      [(ngModel)]="sec.margin"
                    />
                  </td>
                  <td class="px-4 py-2">
                    <input
                      class="w-full rounded-md border border-slate-300 px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                      [(ngModel)]="sec.ltv"
                    />
                  </td>
                  <td class="px-4 py-2">
                    <button
                      type="button"
                      class="rounded-md bg-red-500 px-3 py-1 text-[11px] font-semibold text-white"
                      (click)="removeSecurity(i)"
                    >
                      X
                    </button>
                  </td>
                </tr>
                <tr *ngIf="!securities.length">
                  <td class="px-4 py-3 text-center text-[11px] text-slate-500" colspan="5">
                    No securities added yet. Use "Add Security" to configure collateral.
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="flex items-center justify-between pt-4">
          <button
            type="button"
            class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
            routerLink="/loms/product"
          >
            Cancel
          </button>
          <div class="flex items-center gap-2">
            <button
              type="button"
              class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
            >
              Save Draft
            </button>
            <button
              type="button"
              class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
              (click)="previous()"
            >
              Previous
            </button>
            <button
              type="button"
              class="rounded-md bg-blue-600 px-4 py-2 text-xs font-semibold text-white hover:bg-blue-700"
              (click)="next()"
            >
              Next
            </button>
          </div>
        </div>
      </section>
    </ng-container>

    <ng-container *ngIf="activeStep === 5">
      <section class="rounded-2xl border border-slate-200 bg-white px-6 py-5 shadow-sm space-y-5 text-sm">
        <h2 class="text-lg font-semibold text-slate-900">
          Terms, Limits, Pricing &amp; Charges
        </h2>

        <div class="space-y-4">
          <h3 class="text-sm font-semibold text-slate-900">
            (A) Loan Terms *
          </h3>
          <div class="grid gap-4 md:grid-cols-4">
            <div class="space-y-1">
              <div class="text-[11px] font-semibold text-slate-600">
                Min Loan Amount
              </div>
              <input
                class="w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="minLoanAmount"
              />
            </div>
            <div class="space-y-1">
              <div class="text-[11px] font-semibold text-slate-600">
                Max Loan Amount
              </div>
              <input
                class="w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="maxLoanAmount"
              />
            </div>
            <div class="space-y-1">
              <div class="text-[11px] font-semibold text-slate-600">
                Min Tenor (months)
              </div>
              <input
                class="w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="minTenorMonths"
              />
            </div>
            <div class="space-y-1">
              <div class="text-[11px] font-semibold text-slate-600">
                Max Tenor (months)
              </div>
              <input
                class="w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="maxTenorMonths"
              />
            </div>
          </div>

          <div class="space-y-1">
            <div class="text-[11px] font-semibold text-slate-600">
              Repayment Type
            </div>
            <select
              class="max-w-xs rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="selectedRepaymentType"
            >
              <option value="" disabled>Select...</option>
              <option *ngFor="let rt of repaymentTypes" [ngValue]="rt">
                {{ rt }}
              </option>
            </select>
          </div>
        </div>

        <div class="space-y-4">
          <h3 class="text-sm font-semibold text-slate-900">
            (B) Pricing *
          </h3>
          <div class="grid gap-4 md:grid-cols-3">
            <div class="space-y-1">
              <div class="text-[11px] font-semibold text-slate-600">
                Interest/Profit Rate
              </div>
              <input
                placeholder="e.g. 9-12%"
                class="w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="interestRate"
              />
            </div>
            <div class="space-y-1">
              <div class="text-[11px] font-semibold text-slate-600">
                Penal Interest Rate
              </div>
              <input
                class="w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="penalInterestRate"
              />
            </div>
            <div class="space-y-1">
              <div class="text-[11px] font-semibold text-slate-600">
                Insurance Required?
              </div>
              <select
                class="w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="insuranceRequired"
              >
                <option value="" disabled>Select...</option>
                <option *ngFor="let r of requiredOptions" [ngValue]="r">
                  {{ r }}
                </option>
              </select>
            </div>
          </div>
        </div>

        <div class="space-y-3">
          <h3 class="text-sm font-semibold text-slate-900">
            (C) Charges Configuration *
          </h3>
          <div class="space-y-3">
            <button
              type="button"
              class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
              (click)="addCharge()"
            >
              + Add Charge
            </button>

            <div class="overflow-x-auto rounded-md border border-slate-200">
              <table class="min-w-full border-collapse text-xs">
                <thead class="bg-slate-50 text-[11px] font-semibold text-slate-600">
                  <tr>
                    <th class="px-4 py-2 text-left">Charge Type</th>
                    <th class="px-4 py-2 text-left">Type</th>
                    <th class="px-4 py-2 text-left">Amount/Rate</th>
                    <th class="px-4 py-2 text-left">VAT?</th>
                    <th class="px-4 py-2 text-left">Applicability</th>
                    <th class="px-4 py-2 text-left">Mandatory?</th>
                    <th class="px-4 py-2 text-left">Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let ch of charges; let i = index">
                    <td class="px-4 py-2">
                      <select
                        class="w-full rounded-md border border-slate-300 bg-white px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                        [(ngModel)]="ch.chargeType"
                      >
                        <option value="" disabled>Select</option>
                        <option *ngFor="let ct of chargeTypes" [ngValue]="ct">
                          {{ ct }}
                        </option>
                      </select>
                    </td>
                    <td class="px-4 py-2">
                      <select
                        class="w-full rounded-md border border-slate-300 bg-white px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                        [(ngModel)]="ch.type"
                      >
                        <option value="" disabled>Select</option>
                        <option *ngFor="let ct of chargeTypeKinds" [ngValue]="ct">
                          {{ ct }}
                        </option>
                      </select>
                    </td>
                    <td class="px-4 py-2">
                      <input
                        class="w-full rounded-md border border-slate-300 px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                        [(ngModel)]="ch.amountOrRate"
                      />
                    </td>
                    <td class="px-4 py-2">
                      <select
                        class="w-full rounded-md border border-slate-300 bg-white px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                        [(ngModel)]="ch.vat"
                      >
                        <option value="" disabled>Select</option>
                        <option *ngFor="let r of requiredOptions" [ngValue]="r">
                          {{ r }}
                        </option>
                      </select>
                    </td>
                    <td class="px-4 py-2">
                      <select
                        class="w-full rounded-md border border-slate-300 bg-white px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                        [(ngModel)]="ch.applicability"
                      >
                        <option value="" disabled>Select</option>
                        <option *ngFor="let app of chargeApplicabilities" [ngValue]="app">
                          {{ app }}
                        </option>
                      </select>
                    </td>
                    <td class="px-4 py-2">
                      <select
                        class="w-full rounded-md border border-slate-300 bg-white px-2 py-1 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                        [(ngModel)]="ch.mandatory"
                      >
                        <option value="" disabled>Select</option>
                        <option *ngFor="let r of requiredOptions" [ngValue]="r">
                          {{ r }}
                        </option>
                      </select>
                    </td>
                    <td class="px-4 py-2">
                      <button
                        type="button"
                        class="rounded-md bg-red-500 px-3 py-1 text-[11px] font-semibold text-white"
                        (click)="removeCharge(i)"
                      >
                        X
                      </button>
                    </td>
                  </tr>
                  <tr *ngIf="!charges.length">
                    <td class="px-4 py-3 text-center text-[11px] text-slate-500" colspan="7">
                      No charges added yet. Use "Add Charge" to configure pricing charges.
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="flex items-center justify-between pt-4">
          <button
            type="button"
            class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
            routerLink="/loms/product"
          >
            Cancel
          </button>
          <div class="flex items-center gap-2">
            <button
              type="button"
              class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
            >
              Save Draft
            </button>
            <button
              type="button"
              class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
              (click)="previous()"
            >
              Previous
            </button>
            <button
              type="button"
              class="rounded-md bg-blue-600 px-4 py-2 text-xs font-semibold text-white hover:bg-blue-700"
              (click)="next()"
            >
              Next
            </button>
          </div>
        </div>
      </section>
    </ng-container>

    <ng-container *ngIf="activeStep === 6">
      <section class="rounded-2xl border border-slate-200 bg-white px-6 py-5 shadow-sm space-y-4 text-sm">
        <h2 class="text-lg font-semibold text-slate-900">
          Review &amp; Confirm
        </h2>
        <p class="text-xs text-slate-600">
          Review all captured details across attributes, segments, documents, security, terms and charges before submitting for approval.
        </p>

        <div class="space-y-5">
          <div class="grid gap-4 md:grid-cols-2">
            <div class="space-y-3">
              <h3 class="text-xs font-semibold uppercase tracking-wide text-slate-500">
                Product Summary
              </h3>
              <div class="space-y-1 text-xs">
                <div class="flex justify-between">
                  <span class="text-slate-500">Product Code</span>
                  <span class="font-medium text-slate-900">{{ productCode || '-' }}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Name</span>
                  <span class="font-medium text-slate-900">{{ productName || '-' }}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Business Line</span>
                  <span class="font-medium text-slate-900">{{ selectedBusinessLine || '-' }}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Product Type</span>
                  <span class="font-medium text-slate-900">{{ selectedProductType || '-' }}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Currency</span>
                  <span class="font-medium text-slate-900">{{ selectedCurrency || '-' }}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Interest Type</span>
                  <span class="font-medium text-slate-900">{{ selectedInterestType || '-' }}</span>
                </div>
              </div>
            </div>
            <div class="space-y-3">
              <h3 class="text-xs font-semibold uppercase tracking-wide text-slate-500">
                Customer Segment &amp; Eligibility
              </h3>
              <div class="space-y-1 text-xs">
                <div class="flex justify-between">
                  <span class="text-slate-500">Segment</span>
                  <span class="font-medium text-slate-900">{{ selectedSegment || '-' }}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Gender</span>
                  <span class="font-medium text-slate-900">{{ selectedGender || '-' }}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Co-applicant Required</span>
                  <span class="font-medium text-slate-900">{{ coApplicantRequired || '-' }}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Guarantor Required</span>
                  <span class="font-medium text-slate-900">{{ guarantorRequired || '-' }}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Persona</span>
                  <span class="font-medium text-slate-900">{{ getSelectedPersonas() || '-' }}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Min Age</span>
                  <span class="font-medium text-slate-900">{{ minAge || '-' }}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Max Age</span>
                  <span class="font-medium text-slate-900">{{ maxAge || '-' }}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Minimum Income</span>
                  <span class="font-medium text-slate-900">{{ minimumIncome || '-' }}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Business Vintage (months)</span>
                  <span class="font-medium text-slate-900">{{ businessVintageMonths || '-' }}</span>
                </div>
              </div>
            </div>
          </div>

          <div class="space-y-3">
            <h3 class="text-xs font-semibold uppercase tracking-wide text-slate-500">
              Channels &amp; Description
            </h3>
            <div class="grid gap-4 md:grid-cols-2 text-xs">
              <div class="space-y-1">
                <div class="text-slate-500">Channels</div>
                <div class="font-medium text-slate-900">
                  {{ getSelectedChannels() || '-' }}
                </div>
              </div>
              <div class="space-y-1">
                <div class="text-slate-500">Description</div>
                <div class="rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-slate-800 min-h-[44px]">
                  {{ description || 'No description provided.' }}
                </div>
              </div>
            </div>
          </div>

          <div class="space-y-3">
            <h3 class="text-xs font-semibold uppercase tracking-wide text-slate-500">
              Required Documents
            </h3>
            <div class="overflow-x-auto rounded-md border border-slate-200">
              <table class="min-w-full border-collapse text-xs">
                <thead class="bg-slate-50 text-[11px] font-semibold text-slate-600">
                  <tr>
                    <th class="px-4 py-2 text-left">Document Type</th>
                    <th class="px-4 py-2 text-left">Persona</th>
                    <th class="px-4 py-2 text-left">Workflow Stage</th>
                    <th class="px-4 py-2 text-left">Required?</th>
                    <th class="px-4 py-2 text-left">Conditional Rule</th>
                    <th class="px-4 py-2 text-left">Notes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let doc of documents">
                    <td class="px-4 py-2">{{ doc.documentType || '-' }}</td>
                    <td class="px-4 py-2">{{ doc.personaType || '-' }}</td>
                    <td class="px-4 py-2">{{ doc.workflowStage || '-' }}</td>
                    <td class="px-4 py-2">{{ doc.required || '-' }}</td>
                    <td class="px-4 py-2">{{ doc.conditionalRule || '-' }}</td>
                    <td class="px-4 py-2">{{ doc.notes || '-' }}</td>
                  </tr>
                  <tr *ngIf="!documents.length">
                    <td class="px-4 py-3 text-center text-[11px] text-slate-500" colspan="6">
                      No documents configured.
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="space-y-3">
            <h3 class="text-xs font-semibold uppercase tracking-wide text-slate-500">
              Security / Collateral Mapping
            </h3>
            <div class="overflow-x-auto rounded-md border border-slate-200">
              <table class="min-w-full border-collapse text-xs">
                <thead class="bg-slate-50 text-[11px] font-semibold text-slate-600">
                  <tr>
                    <th class="px-4 py-2 text-left">Security Type</th>
                    <th class="px-4 py-2 text-left">Valuation Req?</th>
                    <th class="px-4 py-2 text-left">Margin %</th>
                    <th class="px-4 py-2 text-left">LTV %</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let sec of securities">
                    <td class="px-4 py-2">{{ sec.securityType || '-' }}</td>
                    <td class="px-4 py-2">{{ sec.valuationRequired || '-' }}</td>
                    <td class="px-4 py-2">{{ sec.margin || '-' }}</td>
                    <td class="px-4 py-2">{{ sec.ltv || '-' }}</td>
                  </tr>
                  <tr *ngIf="!securities.length">
                    <td class="px-4 py-3 text-center text-[11px] text-slate-500" colspan="4">
                      No securities configured.
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="space-y-3">
            <h3 class="text-xs font-semibold uppercase tracking-wide text-slate-500">
              Terms, Pricing &amp; Charges
            </h3>
            <div class="grid gap-4 md:grid-cols-2 text-xs">
              <div class="space-y-1">
                <div class="text-slate-500">Loan Amount Range</div>
                <div class="font-medium text-slate-900">
                  {{ minLoanAmount || '-' }} - {{ maxLoanAmount || '-' }}
                </div>
              </div>
              <div class="space-y-1">
                <div class="text-slate-500">Tenor (months)</div>
                <div class="font-medium text-slate-900">
                  {{ minTenorMonths || '-' }} - {{ maxTenorMonths || '-' }}
                </div>
              </div>
              <div class="space-y-1">
                <div class="text-slate-500">Repayment Type</div>
                <div class="font-medium text-slate-900">
                  {{ selectedRepaymentType || '-' }}
                </div>
              </div>
              <div class="space-y-1">
                <div class="text-slate-500">Interest / Penal / Insurance</div>
                <div class="font-medium text-slate-900">
                  {{ interestRate || '-' }} / {{ penalInterestRate || '-' }} / {{ insuranceRequired || '-' }}
                </div>
              </div>
            </div>

            <div class="overflow-x-auto rounded-md border border-slate-200">
              <table class="min-w-full border-collapse text-xs">
                <thead class="bg-slate-50 text-[11px] font-semibold text-slate-600">
                  <tr>
                    <th class="px-4 py-2 text-left">Charge Type</th>
                    <th class="px-4 py-2 text-left">Type</th>
                    <th class="px-4 py-2 text-left">Amount/Rate</th>
                    <th class="px-4 py-2 text-left">VAT?</th>
                    <th class="px-4 py-2 text-left">Applicability</th>
                    <th class="px-4 py-2 text-left">Mandatory?</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let ch of charges">
                    <td class="px-4 py-2">{{ ch.chargeType || '-' }}</td>
                    <td class="px-4 py-2">{{ ch.type || '-' }}</td>
                    <td class="px-4 py-2">{{ ch.amountOrRate || '-' }}</td>
                    <td class="px-4 py-2">{{ ch.vat || '-' }}</td>
                    <td class="px-4 py-2">{{ ch.applicability || '-' }}</td>
                    <td class="px-4 py-2">{{ ch.mandatory || '-' }}</td>
                  </tr>
                  <tr *ngIf="!charges.length">
                    <td class="px-4 py-3 text-center text-[11px] text-slate-500" colspan="6">
                      No charges configured.
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="flex items-center justify-between pt-4">
          <button
            type="button"
            class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
            routerLink="/loms/product"
          >
            Cancel
          </button>
          <div class="flex items-center gap-2">
            <button
              type="button"
              class="rounded-md border border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-200"
              (click)="previous()"
            >
              Previous
            </button>
            <button
              type="button"
              class="rounded-md bg-blue-600 px-4 py-2 text-xs font-semibold text-white hover:bg-blue-700"
              (click)="submitForApproval()"
            >
              Submit for Approval
            </button>
          </div>
        </div>
      </section>
    </ng-container>
  </div>
</app-loms-layout>
