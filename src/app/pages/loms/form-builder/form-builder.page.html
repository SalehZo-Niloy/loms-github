<app-loms-layout
  organisationName="Loan Origination and Management System"
  solutionName="LOMS"
  breadcrumb="Self Defined Form Builder"
  basePath="/loms"
>
  <div class="px-2 py-4 bg-white-50 min-h-screen space-y-4 w-full flex-1 max-w-screen-2xl mx-auto">
    <section class="rounded-2xl border border-slate-200 bg-white px-6 py-4 shadow-sm space-y-4">
      <div class="flex flex-col gap-4 lg:flex-row lg:items-end lg:justify-between">
        <div class="flex flex-1 flex-col gap-3">
          <div class="grid gap-3 md:grid-cols-[minmax(0,2fr)_minmax(0,3fr)]">
            <div class="space-y-1 text-xs">
              <div class="text-[11px] font-semibold text-slate-600">
                Product
              </div>
              <select
                class="w-full rounded-md border border-slate-300 bg-slate-50 px-3 py-2 text-xs text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="selectedProduct"
                (ngModelChange)="onSelectProduct($event)"
              >
                <option value="">
                  Select Product...
                </option>
                <option *ngFor="let p of products" [ngValue]="p">
                  {{ p }}
                </option>
              </select>
            </div>
            <!-- <div class="space-y-1 text-xs">
              <div class="text-[11px] font-semibold text-slate-600">
                Applicable Roles
              </div>
              <div class="flex flex-wrap gap-2 rounded-md border border-slate-200 bg-slate-50 px-3 py-1.5 min-h-[40px]">
                <button
                  *ngFor="let role of roles"
                  type="button"
                  class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-[11px] font-medium"
                  [ngClass]="selectedRoles.includes(role)
                    ? 'border-blue-500 bg-blue-50 text-blue-700'
                    : 'border-slate-200 bg-white text-slate-600'"
                  (click)="toggleRole(role)"
                >
                  {{ role }}
                </button>
                <span
                  *ngIf="!selectedRoles.length"
                  class="text-[11px] text-slate-400 self-center"
                >
                  No roles selected
                </span>
              </div>
            </div> -->
          </div>
        </div>
        <div class="flex flex-col gap-2 text-xs lg:w-[420px]">
          <div class="grid gap-3 md:grid-cols-[minmax(0,3fr)_minmax(0,1fr)]">
            <div class="space-y-1">
              <div class="text-[11px] font-semibold text-slate-600">
                Select Form
              </div>
              <select
                class="w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-xs text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="selectedFormId"
                (ngModelChange)="selectForm($event)"
              >
                <option value="">
                  Select existing form...
                </option>
                <option *ngFor="let f of availableForms" [ngValue]="f.id">
                  {{ f.name }} (v{{ f.version }})
                </option>
              </select>
            </div>
            <div class="space-y-1">
              <div class="flex items-center justify-between text-[11px] text-slate-500">
                <span>Status</span>
              </div>
              <div
                class="inline-flex items-center justify-center rounded-md border px-3 py-1 text-[11px] font-semibold"
                [ngClass]="{
                  'border-slate-200 bg-slate-50 text-slate-600': status === 'NONE',
                  'border-amber-200 bg-amber-50 text-amber-700': status === 'DRAFT',
                  'border-emerald-200 bg-emerald-50 text-emerald-700': status === 'ACTIVE'
                }"
              >
                {{ status }}
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="flex flex-wrap gap-3 text-xs">
        <button
          type="button"
          class="inline-flex items-center rounded-md bg-blue-600 px-4 py-1.5 text-xs font-semibold text-white hover:bg-blue-700"
          (click)="openCreateForm()"
        >
          + Create New Form
        </button>
        <button
          type="button"
          class="inline-flex items-center rounded-md border border-slate-300 bg-white px-4 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50"
          (click)="resetForm()"
          [disabled]="!currentForm"
        >
          Reset
        </button>
        <button
          type="button"
          class="inline-flex items-center rounded-md border border-slate-300 bg-white px-4 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50"
          (click)="cloneForm()"
          [disabled]="!currentForm"
        >
          Clone Form
        </button>
        <button
          type="button"
          class="inline-flex items-center rounded-md border border-slate-300 bg-white px-4 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50"
          (click)="saveDraft()"
          [disabled]="!currentForm"
        >
          Save Draft
        </button>
        <button
          type="button"
          class="inline-flex items-center rounded-md bg-blue-600 px-4 py-1.5 text-xs font-semibold text-white hover:bg-blue-700"
          (click)="publish()"
          [disabled]="!currentForm || !currentForm.fields.length"
        >
          Publish / Activate
        </button>
      </div>
    </section>

    <section class="grid gap-4 lg:grid-cols-[minmax(0,3fr)_minmax(0,2fr)]">
      <div class="rounded-2xl border border-slate-200 bg-white px-4 py-4 shadow-sm flex flex-col">
        <div class="flex items-center justify-between mb-3">
          <h2 class="text-sm font-semibold text-slate-900">
            Fields Configuration
          </h2>
          <button
            type="button"
            class="inline-flex items-center rounded-md bg-blue-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-blue-700"
            (click)="openAddField()"
            [disabled]="!currentForm"
          >
            + Add Field
          </button>
        </div>

        <div class="flex items-center justify-between mb-2 text-xs">
          <div class="flex items-center gap-2">
            <select
              class="rounded-md border border-slate-300 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="sectionFilter"
            >
              <option value="All Sections">
                All Sections
              </option>
              <option *ngFor="let s of sectionOptions" [ngValue]="s">
                {{ s }}
              </option>
            </select>
          </div>
          <div class="flex items-center gap-4">
            <label class="inline-flex items-center gap-1">
              <input
                type="checkbox"
                class="h-3.5 w-3.5 rounded border-slate-300"
                [(ngModel)]="showOnlyChanged"
              />
              <span class="text-[11px] text-slate-600">Show only changed</span>
            </label>
            <label class="inline-flex items-center gap-1">
              <input
                type="checkbox"
                class="h-3.5 w-3.5 rounded border-slate-300"
                [(ngModel)]="showOnlyMandatory"
              />
              <span class="text-[11px] text-slate-600">Show only mandatory</span>
            </label>
          </div>
        </div>

        <div class="border border-slate-200 rounded-lg overflow-hidden flex-1">
          <div class="grid grid-cols-[minmax(0,2fr)_90px_40px_40px_40px_50px_minmax(0,1fr)_80px] border-b border-slate-200 bg-slate-50 px-3 py-2 text-[11px] font-semibold text-slate-500">
            <div>Field Name / Key</div>
            <div class="text-center">Type</div>
            <div class="text-center">Vis</div>
            <div class="text-center">Dis</div>
            <div class="text-center">R/O</div>
            <div class="text-center">Req</div>
            <div>Validation</div>
            <div class="text-center">Actions</div>
          </div>

          <div *ngIf="!currentForm" class="px-4 py-6 text-xs text-slate-500">
            Select or create a form to start configuring fields.
          </div>

          <ng-container *ngIf="currentForm">
            <div *ngIf="!filteredFields.length" class="px-4 py-6 text-xs text-slate-500">
              No fields match the selected filters.
            </div>

            <div
              *ngFor="let field of filteredFields"
              class="grid grid-cols-[minmax(0,2fr)_90px_40px_40px_40px_50px_minmax(0,1fr)_80px] items-center border-t border-slate-100 px-3 py-2 text-xs"
            >
              <div class="flex flex-col">
                <div class="font-medium text-slate-900">
                  {{ field.label }}
                </div>
                <div class="text-[11px] text-slate-500">
                  {{ field.key }}
                  <span *ngIf="field.section" class="ml-1 text-[10px] uppercase tracking-wide text-slate-400">
                    • {{ field.section }}
                  </span>
                </div>
              </div>
              <div class="text-center text-[11px] text-slate-700">
                {{ getFieldTypeLabel(field) }}
              </div>
              <div class="flex items-center justify-center">
                <input
                  type="checkbox"
                  class="h-3.5 w-3.5 rounded border-slate-300"
                  [checked]="field.visible"
                  (change)="toggleFieldFlag(field, 'visible')"
                />
              </div>
              <div class="flex items-center justify-center">
                <input
                  type="checkbox"
                  class="h-3.5 w-3.5 rounded border-slate-300"
                  [checked]="field.disabled"
                  (change)="toggleFieldFlag(field, 'disabled')"
                />
              </div>
              <div class="flex items-center justify-center">
                <input
                  type="checkbox"
                  class="h-3.5 w-3.5 rounded border-slate-300"
                  [checked]="field.readOnly"
                  (change)="toggleFieldFlag(field, 'readOnly')"
                />
              </div>
              <div class="flex items-center justify-center">
                <input
                  type="checkbox"
                  class="h-3.5 w-3.5 rounded border-slate-300"
                  [checked]="field.required"
                  (change)="toggleFieldFlag(field, 'required')"
                />
              </div>
              <div class="text-[11px] text-slate-700">
                {{ field.validationRule === 'None' ? 'None' : field.validationRule }}
              </div>
              <div class="flex items-center justify-center gap-2 text-[11px]">
                <button
                  type="button"
                  class="text-blue-600 hover:underline"
                  (click)="openEditField(field)"
                >
                  Edit
                </button>
                <button
                  type="button"
                  class="text-red-600 hover:underline"
                  (click)="removeField(field)"
                >
                  Remove
                </button>
              </div>
            </div>
          </ng-container>
        </div>
      </div>

      <div class="rounded-2xl border border-slate-200 bg-white px-4 py-4 shadow-sm flex flex-col">
        <div class="flex items-center justify-between mb-3">
          <h2 class="text-sm font-semibold text-slate-900">
            Live Preview
          </h2>
          <div class="flex items-center gap-2 text-[11px]">
            <button
              type="button"
              class="rounded-md border border-slate-300 bg-white px-3 py-1 text-[11px] font-semibold text-slate-600"
              [disabled]="!currentForm"
            >
              Test Submit
            </button>
            <button
              type="button"
              class="rounded-md border border-slate-300 bg-white px-3 py-1 text-[11px] font-semibold text-slate-600"
              [disabled]="!currentForm"
              (click)="previewModel = {}"
            >
              Clear
            </button>
          </div>
        </div>

        <div *ngIf="!currentForm" class="flex-1 px-2 py-4 text-xs text-slate-500">
          Select a form to preview.
        </div>

        <div *ngIf="currentForm as form" class="flex-1 overflow-y-auto px-2 py-2 space-y-4 text-xs">
          <div *ngFor="let section of sectionOptions" class="space-y-2">
            <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-600">
              {{ section }}
            </div>
            <div class="space-y-2">
              <ng-container *ngFor="let field of form.fields">
                <div *ngIf="field.section === section && shouldShowField(field)" class="space-y-1">
                  <label class="block text-[11px] font-medium text-slate-700">
                    {{ field.label }}
                    <span *ngIf="field.required" class="text-red-500">*</span>
                  </label>
                  <ng-container [ngSwitch]="field.type">
                    <input
                      *ngSwitchCase="'text'"
                      type="text"
                      class="w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                      [placeholder]="field.placeholder"
                      [(ngModel)]="previewModel[field.key]"
                      (ngModelChange)="onPreviewValueChange(field, $event)"
                      [readonly]="field.readOnly"
                      [disabled]="field.disabled"
                    />
                    <input
                      *ngSwitchCase="'number'"
                      type="number"
                      class="w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                      [placeholder]="field.placeholder"
                      [(ngModel)]="previewModel[field.key]"
                      (ngModelChange)="onPreviewValueChange(field, $event)"
                      [readonly]="field.readOnly"
                      [disabled]="field.disabled"
                    />
                    <input
                      *ngSwitchCase="'date'"
                      type="date"
                      class="w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                      [(ngModel)]="previewModel[field.key]"
                      (ngModelChange)="onPreviewValueChange(field, $event)"
                      [readonly]="field.readOnly"
                      [disabled]="field.disabled"
                    />
                    <select
                      *ngSwitchCase="'dropdown'"
                      class="w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                      [(ngModel)]="previewModel[field.key]"
                      (ngModelChange)="onPreviewValueChange(field, $event)"
                      [disabled]="field.disabled"
                    >
                      <option value="">
                        Select...
                      </option>
                    </select>
                    <div *ngSwitchCase="'radio'" class="flex items-center gap-4">
                      <label class="inline-flex items-center gap-1">
                        <input
                          type="radio"
                          class="h-3.5 w-3.5 border-slate-300 text-blue-600"
                          [value]="'Yes'"
                          name="{{ field.key }}"
                          [(ngModel)]="previewModel[field.key]"
                          (ngModelChange)="onPreviewValueChange(field, $event)"
                          [disabled]="field.disabled"
                        />
                        <span>Yes</span>
                      </label>
                      <label class="inline-flex items-center gap-1">
                        <input
                          type="radio"
                          class="h-3.5 w-3.5 border-slate-300 text-blue-600"
                          [value]="'No'"
                          name="{{ field.key }}"
                          [(ngModel)]="previewModel[field.key]"
                          (ngModelChange)="onPreviewValueChange(field, $event)"
                          [disabled]="field.disabled"
                        />
                        <span>No</span>
                      </label>
                    </div>
                  </ng-container>
                  <div *ngIf="field.tooltip" class="text-[10px] text-slate-500">
                    {{ field.tooltip }}
                  </div>
                </div>
              </ng-container>
            </div>
          </div>
        </div>
      </div>
    </section>

    <div
      *ngIf="showCreateFormModal"
      class="fixed inset-0 z-40 flex items-center justify-center bg-slate-900/40"
    >
      <div class="w-full max-w-xl rounded-2xl bg-white p-5 text-xs shadow-xl">
        <div class="flex items-center justify-between mb-3">
          <div class="text-sm font-semibold text-slate-900">
            Create New Form
          </div>
          <button
            type="button"
            class="text-lg leading-none text-slate-400 hover:text-slate-600"
            (click)="cancelCreateForm()"
          >
            ×
          </button>
        </div>

        <div class="space-y-3">
          <div class="space-y-1">
            <label class="block text-[11px] font-medium text-slate-700">
              Form Name *
            </label>
            <input
              type="text"
              class="w-full rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="createFormName"
            />
          </div>

          <div class="space-y-1">
            <label class="block text-[11px] font-medium text-slate-700">
              Product *
            </label>
            <select
              class="w-full rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="createFormProduct"
            >
              <option value="">
                Select Product...
              </option>
              <option *ngFor="let p of products" [ngValue]="p">
                {{ p }}
              </option>
            </select>
          </div>

          <div class="space-y-1">
            <label class="block text-[11px] font-medium text-slate-700">
              Applicable Roles *
            </label>
            <div class="grid grid-cols-2 gap-2 text-[11px] text-slate-700">
              <label
                *ngFor="let role of roles"
                class="inline-flex items-center gap-2"
              >
                <input
                  type="checkbox"
                  class="h-3.5 w-3.5 rounded border-slate-300"
                  [checked]="createFormRoles.includes(role)"
                  (change)="toggleCreateFormRole(role)"
                />
                <span>{{ role }}</span>
              </label>
            </div>
          </div>
        </div>

        <div class="mt-4 flex items-center justify-end gap-2">
          <button
            type="button"
            class="rounded-md border border-slate-300 bg-white px-4 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50"
            (click)="cancelCreateForm()"
          >
            Cancel
          </button>
          <button
            type="button"
            class="rounded-md bg-blue-600 px-4 py-1.5 text-xs font-semibold text-white hover:bg-blue-700"
            (click)="confirmCreateForm()"
          >
            Create Form
          </button>
        </div>
      </div>
    </div>

    <div
      *ngIf="showFieldModal"
      class="fixed inset-0 z-40 flex items-center justify-center bg-slate-900/40"
    >
      <div class="max-h-[90vh] w-full max-w-lg overflow-y-auto rounded-2xl bg-white p-5 text-xs shadow-xl">
        <div class="flex items-center justify-between mb-3">
          <div class="text-sm font-semibold text-slate-900">
            {{ fieldModalMode === 'create' ? 'Add New Field' : 'Edit Field' }}
          </div>
          <button
            type="button"
            class="text-lg leading-none text-slate-400 hover:text-slate-600"
            (click)="closeFieldModal()"
          >
            ×
          </button>
        </div>

        <div class="space-y-3">
          <div class="grid gap-3 md:grid-cols-2">
            <div class="space-y-1">
              <label class="block text-[11px] font-medium text-slate-700">
                Label *
              </label>
              <input
                type="text"
                class="w-full rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="fieldModal.label"
              />
            </div>
            <div class="space-y-1">
              <label class="block text-[11px] font-medium text-slate-700">
                Key *
              </label>
              <input
                type="text"
                class="w-full rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="fieldModal.key"
              />
            </div>
          </div>

          <div class="grid gap-3 md:grid-cols-2">
            <div class="space-y-1">
              <label class="block text-[11px] font-medium text-slate-700">
                Type *
              </label>
              <select
                class="w-full rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="fieldModal.type"
              >
                <option value="">
                  Select type...
                </option>
                <option [ngValue]="'text'">Text</option>
                <option [ngValue]="'number'">Number</option>
                <option [ngValue]="'date'">Date</option>
                <option [ngValue]="'dropdown'">Dropdown</option>
                <option [ngValue]="'radio'">Radio</option>
              </select>
            </div>
            <div class="space-y-1">
              <label class="block text-[11px] font-medium text-slate-700">
                Section
              </label>
              <input
                type="text"
                class="w-full rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="fieldModal.section"
                placeholder="e.g. PERSONAL INFO"
              />
            </div>
          </div>

          <div class="grid gap-3 md:grid-cols-2">
            <div class="space-y-1">
              <label class="block text-[11px] font-medium text-slate-700">
                Validation Rule
              </label>
              <select
                class="w-full rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="fieldModal.validationRule"
              >
                <option [ngValue]="'None'">None</option>
                <option [ngValue]="'Regex'">Regex</option>
                <option [ngValue]="'MinMax'">Min / Max</option>
              </select>
            </div>
            <div class="space-y-1">
              <label class="block text-[11px] font-medium text-slate-700">
                Placeholder
              </label>
              <input
                type="text"
                class="w-full rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="fieldModal.placeholder"
              />
            </div>
          </div>

          <div class="grid gap-3 md:grid-cols-2">
            <div class="space-y-1">
              <label class="block text-[11px] font-medium text-slate-700">
                Default Value
              </label>
              <input
                type="text"
                class="w-full rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="fieldModal.defaultValue"
              />
            </div>
            <div class="space-y-1">
              <label class="block text-[11px] font-medium text-slate-700">
                Tooltip
              </label>
              <input
                type="text"
                class="w-full rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="fieldModal.tooltip"
              />
            </div>
          </div>

          <div class="grid gap-3 md:grid-cols-2">
            <div class="space-y-1">
              <label class="block text-[11px] font-medium text-slate-700">
                Min Length/Val
              </label>
              <input
                type="text"
                class="w-full rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="fieldModal.minValue"
              />
            </div>
            <div class="space-y-1">
              <label class="block text-[11px] font-medium text-slate-700">
                Max Length/Val
              </label>
              <input
                type="text"
                class="w-full rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="fieldModal.maxValue"
              />
            </div>
          </div>

          <div class="space-y-1">
            <div class="text-[11px] font-medium text-slate-700">
              Flags
            </div>
            <div class="grid grid-cols-2 gap-2 text-[11px] text-slate-700">
              <label class="inline-flex items-center gap-2">
                <input
                  type="checkbox"
                  class="h-3.5 w-3.5 rounded border-slate-300"
                  [(ngModel)]="fieldModal.visible"
                />
                <span>Visible</span>
              </label>
              <label class="inline-flex items-center gap-2">
                <input
                  type="checkbox"
                  class="h-3.5 w-3.5 rounded border-slate-300"
                  [(ngModel)]="fieldModal.disabled"
                />
                <span>Disabled</span>
              </label>
              <label class="inline-flex items-center gap-2">
                <input
                  type="checkbox"
                  class="h-3.5 w-3.5 rounded border-slate-300"
                  [(ngModel)]="fieldModal.readOnly"
                />
                <span>Read Only</span>
              </label>
              <label class="inline-flex items-center gap-2">
                <input
                  type="checkbox"
                  class="h-3.5 w-3.5 rounded border-slate-300"
                  [(ngModel)]="fieldModal.required"
                />
                <span>Required</span>
              </label>
              <label class="inline-flex items-center gap-2">
                <input
                  type="checkbox"
                  class="h-3.5 w-3.5 rounded border-slate-300"
                  [(ngModel)]="fieldModal.optional"
                />
                <span>Optional</span>
              </label>
            </div>
          </div>

          <div class="space-y-2 border-t border-slate-200 pt-3">
            <div class="text-[11px] font-semibold text-slate-700">
              Conditional Logic (Show When)
            </div>
            <div class="grid gap-2 md:grid-cols-[minmax(0,2fr)_minmax(0,1.5fr)_minmax(0,2fr)]">
              <select
                class="rounded-md border border-slate-300 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="fieldModal.conditionFieldKey"
              >
                <option value="">
                  Select field...
                </option>
                <option
                  *ngFor="let f of currentForm?.fields || []"
                  [ngValue]="f.key"
                >
                  {{ f.label }}
                </option>
              </select>
              <select
                class="rounded-md border border-slate-300 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="fieldModal.conditionOperator"
              >
                <option [ngValue]="'equals'">Equals</option>
                <option [ngValue]="'notEquals'">Not Equals</option>
              </select>
              <input
                type="text"
                class="w-full rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-100 focus:border-blue-300"
                [(ngModel)]="fieldModal.conditionValue"
                placeholder="Value"
              />
            </div>
          </div>
        </div>

        <div class="mt-4 flex items-center justify-end gap-2">
          <button
            type="button"
            class="rounded-md border border-slate-300 bg-white px-4 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50"
            (click)="closeFieldModal()"
          >
            Cancel
          </button>
          <button
            type="button"
            class="rounded-md bg-blue-600 px-4 py-1.5 text-xs font-semibold text-white hover:bg-blue-700"
            (click)="saveField()"
          >
            Save Field
          </button>
        </div>
      </div>
    </div>
  </div>
</app-loms-layout>
