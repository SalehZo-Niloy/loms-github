<app-loms-layout
  organisationName="Loan Origination and Management System"
  solutionName="LOMS"
  breadcrumb="Submission"
  basePath="/loms"
>
  <div class="px-2 py-4 bg-white-50 min-h-screen space-y-4 w-full flex-1 max-w-screen-xl mx-auto">
    <section class="flex items-center justify-between">
      <h1 class="text-2xl font-semibold text-slate-900">
        Submission
      </h1>
     
    </section>

    <section class="rounded-md border border-slate-200 bg-white shadow-sm">
      <div class="grid gap-0 md:grid-cols-[260px,minmax(0,1fr),260px]">
        <div class="border-r border-slate-200 bg-slate-50 p-4 text-xs space-y-3">
          <h2 class="text-xs font-semibold text-black-700">
            Application Summary
          </h2>
          <div class="space-y-1 text-slate-800">
            <div>
              <span class="font-semibold text-slate-700">App No:</span>
              <span class="ml-1">{{ appNo }}</span>
            </div>
            <div>
              <span class="font-semibold text-slate-700">Customer:</span>
              <span class="ml-1">{{ customerName }}</span>
            </div>
            <div>
              <span class="font-semibold text-slate-700">Product:</span>
              <span class="ml-1">{{ productName }}</span>
            </div>
            <div>
              <span class="font-semibold text-slate-700">Due:</span>
              <span class="ml-1">
                {{ dueAt | date: 'M/d/yyyy, h:mm:ss a' }}
              </span>
            </div>
          </div>

          <div class="pt-3 border-t border-slate-200 space-y-1">
            <div class="font-semibold text-slate-700">
              Recipients
            </div>
            <select
              class="mt-1 w-full rounded-md border border-slate-300 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="selectedRecipientId"
            >
              <option *ngFor="let r of recipients" [ngValue]="r.id">
                {{ r.label }}
              </option>
            </select>
          </div>
        </div>

        <div class="flex flex-col border-r border-slate-200">
          <div class="flex-1 overflow-y-auto p-4 space-y-3">
            <div
              *ngFor="let m of messages"
              class="flex flex-col items-start text-xs"
            >
              <div
                class="max-w-sm rounded-lg px-3 py-2"
                [ngClass]="
                  m.role === 'QUESTION'
                    ? 'bg-blue-50 text-slate-900'
                    : 'bg-slate-100 text-slate-900'
                "
              >
                <div class="mb-1 text-[11px] font-semibold text-slate-600">
                  {{ m.senderLabel }}
                  <span class="ml-1 text-[10px] text-slate-400">
                    {{ m.createdAt | date: 'M/d/yyyy, h:mm a' }}
                  </span>
                </div>
                <div class="text-xs">
                  {{ m.text }}
                </div>
                <div
                  *ngIf="m.attachments?.length"
                  class="mt-2 inline-flex items-center gap-1 rounded-full border border-slate-300 bg-white px-2 py-0.5 text-[11px] text-slate-700"
                >
                  <span class="inline-flex h-4 w-4 items-center justify-center rounded-full bg-slate-100 text-[10px]">
                    â§‰
                  </span>
                  <span *ngFor="let file of m.attachments">
                    {{ file }}
                  </span>
                </div>
              </div>
            </div>
          </div>

          <div class="border-t border-slate-200 p-4 space-y-2">
            <textarea
              rows="3"
              class="w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-300"
              [(ngModel)]="responseText"
              placeholder="Remarks"
            ></textarea>
            <div class="flex items-center justify-end">
              <button
                type="button"
                class="rounded-md bg-blue-600 px-6 py-2 text-sm font-semibold text-white hover:bg-blue-700"
                (click)="submitResponse()
                "
              >
                Submit
              </button>
            </div>
          </div>
        </div>

        <div class="p-4 space-y-3 text-xs">
          <h3 class="text-xs font-semibold uppercase tracking-wide text-slate-500">
            Activity Log
          </h3>
          <div class="space-y-3">
            <div
              *ngFor="let log of activityLog; let last = last"
              class="relative pl-4"
            >
              <div
                class="absolute left-0 top-1.5 h-2 w-2 rounded-full"
                [ngClass]="last ? 'bg-blue-600' : 'bg-slate-400'"
              ></div>
              <div class="text-[11px] text-slate-500">
                {{ log.timestamp | date: 'M/d/yyyy, h:mm:ss a' }}
              </div>
              <div class="text-slate-800">
                <span class="font-semibold">{{ log.actor }}</span>
                <span class="ml-1 uppercase text-[10px] text-slate-500">
                  {{ log.action }}
                </span>
              </div>
              <div class="text-slate-600" *ngIf="log.note">
                {{ log.note }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</app-loms-layout>

